<!doctype html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <style>
            html, body {
                margin:0;
                font-family:sans-serif;
            } 
            
            #cabeza {
                height:10vh;
            } .bocas {

            } input {
                width:6em;
            }

            @media (orientation:landscape) {
                .bocas {
                    display:inline;
                }
            }
            
            
            
            #cuerpo {
                height:90vh;
                display:grid;
                grid-template-columns:auto auto auto auto;
                user-select:none;
            } .pads {
                outline:black 1px solid;
                display:flex;
                flex-direction:column;
                width:25vw;
                height:22.5vh;
            } .indices {
                text-align:center;
                flex-grow:1;
            } .ratios {
                flex-grow:1;
                text-align:center;
            } .decimals {
                flex-grow:1;
                text-align:center;
            } .frequencies {
                flex-grow:1;
                text-align:center;
            }
        </style>
    </head>
    <body>
        <section id='cabeza'>
            <article class='bocas' id='initBox'><button id='init'>init</button>starting frequency:<input id='startingFrequency' type='number' value='440'>hz</article>

            <article class='bocas'>map: <input id='inputRatio'> to
                <select id='index'>
                    <option value='0'>0</option>
                    <option value='1'>1</option>
                    <option value='2'>2</option>
                    <option value='3'>3</option>
                    <option value='4'>4</option>
                    <option value='5'>5</option>
                    <option value='6'>6</option>
                    <option value='7'>7</option>
                    <option value='8'>8</option>
                    <option value='9'>9</option>
                    <option value='10'>10</option>
                    <option value='11'>11</option>
                    <option value='12'>12</option>
                    <option value='13'>13</option>
                    <option value='14'>14</option>
                    <option value='15'>15</option>
                </select>
                <button id='assign'>assign</button>
            </article>
        </section>
        <section id='cuerpo'>
            <article class='pads' data-index=0>
                <div class='indices'>0</div>
                <div class='ratios'></div>
                <div class='decimals'></div>
                <div class='frequencies'></div>
            </article>
            <article class='pads' data-index=1>
                <div class='indices'>1</div>
                <div class='ratios'></div>
                <div class='decimals'></div>
                <div class='frequencies'></div>
            </article>
            <article class='pads' data-index=2>
                <div class='indices'>2</div>
                <div class='ratios'></div>
                <div class='decimals'></div>
                <div class='frequencies'></div>
            </article>
            <article class='pads' data-index=3>
                <div class='indices'>3</div>
                <div class='ratios'></div>
                <div class='decimals'></div>
                <div class='frequencies'></div>
            </article>
            <article class='pads' data-index=4>
                <div class='indices'>4</div>
                <div class='ratios'></div>
                <div class='decimals'></div>
                <div class='frequencies'></div>
            </article>
            <article class='pads' data-index=5>
                <div class='indices'>5</div>
                <div class='ratios'></div>
                <div class='decimals'></div>
                <div class='frequencies'></div>
            </article>
            <article class='pads' data-index=6>
                <div class='indices'>6</div>
                <div class='ratios'></div>
                <div class='decimals'></div>
                <div class='frequencies'></div>
            </article>
            <article class='pads' data-index=7>
                <div class='indices'>7</div>
                <div class='ratios'></div>
                <div class='decimals'></div>
                <div class='frequencies'></div>
            </article>
            <article class='pads' data-index=8>
                <div class='indices'>8</div>
                <div class='ratios'></div>
                <div class='decimals'></div>
                <div class='frequencies'></div>
            </article>
            <article class='pads' data-index=9>
                <div class='indices'>9</div>
                <div class='ratios'></div>
                <div class='decimals'></div>
                <div class='frequencies'></div>
            </article>
            <article class='pads' data-index=10>
                <div class='indices'>10</div>
                <div class='ratios'></div>
                <div class='decimals'></div>
                <div class='frequencies'></div>
            </article>
            <article class='pads' data-index=11>
                <div class='indices'>11</div>
                <div class='ratios'></div>
                <div class='decimals'></div>
                <div class='frequencies'></div>
            </article>
            <article class='pads' data-index=12>
                <div class='indices'>12</div>
                <div class='ratios'></div>
                <div class='decimals'></div>
                <div class='frequencies'></div>
            </article>
            <article class='pads' data-index=13>
                <div class='indices'>13</div>
                <div class='ratios'></div>
                <div class='decimals'></div>
                <div class='frequencies'></div>
            </article>
            <article class='pads' data-index=14>
                <div class='indices'>14</div>
                <div class='ratios'></div>
                <div class='decimals'></div>
                <div class='frequencies'></div>
            </article>
            <article class='pads' data-index=15>
                <div class='indices'>15</div>
                <div class='ratios'></div>
                <div class='decimals'></div>
                <div class='frequencies'></div>
            </article>
        </section>
    </body>
    <script>

        const inputRato = document.getElementById('inputRatio');

        const pads = document.getElementsByClassName('pads');
        const ratios = document.getElementsByClassName('ratios');
        const decimals = document.getElementsByClassName('decimals');
        const frequencies = document.getElementsByClassName('frequencies');

        let index;

        document.getElementById('assign').addEventListener('click', () => {
            index = parseInt(document.getElementById('index').value);
            ratios[index].innerText = inputRatio.value;
            decimals[index].innerText = eval(inputRatio.value)
                .toPrecision(5).replace(/0+$/, '').replace(/\.$/, '');
            frequencies[index].innerText = eval(eval(inputRatio.value) * document.getElementById('startingFrequency').value)
                .toPrecision(8).replace(/0+$/, '').replace(/\.$/, '');
        });

        let atx;

        document.getElementById('init').addEventListener('click', () => {
            atx = new AudioContext();
        });


        let osc0, osc1, osc2, osc3, osc4, osc5, osc6, osc7, osc8, osc9, osc10, osc11, osc12, osc13, osc14, osc15;
        let vol0, vol1, vol2, vol3, vol4, vol5, vol6, vol7, vol8, vol9, vol10, vol11, vol12, vol13, vol14, vol15;

        class Music {
        constructor(osc, vol, index) {
            this.osc = osc;
            this.vol = vol;
            this.index = index;
            this.playing = false;
        }

        awn() {
            if (this.playing === false) {
                this.osc = atx.createOscillator();
                this.vol = atx.createGain();
                this.osc.frequency.value = eval(document.getElementsByClassName('ratios')[this.index]
                .textContent) * document.getElementById('startingFrequency').value;
                this.vol.gain.value = .1;
                this.osc.connect(this.vol).connect(atx.destination);
                this.osc.start(0);
                    this.playing = true;
                pads[this.index].style.outline = 'solid 3px rebeccapurple';
            }
        }
        auf() {
            this.osc.stop(0);
                this.playing = false;
            pads[this.index].style.outline = 'solid 1px black';
        }
      }

    let notes = [
        new Music(osc0, vol0, 0),
        new Music(osc1, vol1, 1),
        new Music(osc2, vol2, 2),
        new Music(osc3, vol3, 3),
        new Music(osc4, vol4, 4),
        new Music(osc5, vol5, 5),
        new Music(osc6, vol6, 6),
        new Music(osc7, vol7, 7),
        new Music(osc8, vol8, 8),
        new Music(osc9, vol9, 9),
        new Music(osc10, vol10, 10),
        new Music(osc11, vol11, 11),
        new Music(osc12, vol12, 12),
        new Music(osc13, vol13, 13),
        new Music(osc14, vol14, 14),
        new Music(osc15, vol15, 15),
    ];

    window.addEventListener('touchstart', e => {

switch(eval(e.target.parentNode.getAttribute('data-index'))) {

    case 0:
    notes[0].awn();
    break;
    case 1:
    notes[1].awn()
    break;
    case 2:
    notes[2].awn()
    break;
    case 3:
    notes[3].awn()
    break;
    case 4:
    notes[4].awn()
    break;
    case 5:
    notes[5].awn()
    break;
    case 6:
    notes[6].awn()
    break;
    case 7:
    notes[7].awn()
    break;
    case 8:
    notes[8].awn()
    break;
    case 9:
    notes[9].awn()
    break;
    case 10:
    notes[10].awn()
    break;
    case 11:
    notes[11].awn()
    break;
    case 12:
    notes[12].awn()
    break;
    case 13:
    notes[13].awn()
    break;
    case 14:
    notes[14].awn()
    break;
    case 15:
    notes[15].awn()
    break;
}

});

window.addEventListener('touchend', e => {
switch(eval(e.target.parentNode.getAttribute('data-index'))) {

    case 0:
    notes[0].auf()
    break;
    case 1:
    notes[1].auf()
    break;
    case 2:
    notes[2].auf()
    break;
    case 3:
    notes[3].auf()
    break;
    case 4:
    notes[4].auf()
    break;
    case 5:
    notes[5].auf()
    break;
    case 6:
    notes[6].auf()
    break;
    case 7:
    notes[7].auf()
    break;
    case 8:
    notes[8].auf()
    break;
    case 9:
    notes[9].auf()
    break;
    case 10:
    notes[10].auf()
    break;
    case 11:
    notes[11].auf()
    break;
    case 12:
    notes[12].auf()
    break;
    case 13:
    notes[13].auf()
    break;
    case 14:
    notes[14].auf()
    break;
    case 15:
    notes[15].auf()
    break;
}
});

document.getElementById('startingFrequency').addEventListener('change', () => {
    for (let i = 0; i < 16; i++) {
        if (frequencies[i].textContent != '') {
            frequencies[i].innerText = eval(ratios[i].textContent) * document.getElementById('startingFrequency').value
                .toPrecision(5).replace(/0+$/, '').replace(/\.$/, '');
        }
    }
});

    </script>
</html>
